### 前端权限设计思路
- 该项目中权限的实现方式是：通过获取当前用户的权限去比对路由表，生成当前用户具的权限可访问的路由表，通过 router.addRoutes 动态挂载到 router 上。
- token放在cookie中；vuex中也保存token，以及角色和用户其它信息
- 区别：vuex是内存中的，其它都是落盘的，但是生命周期有些是跟随浏览器，有些是session级别，有些是永久

#### src/permission.js
- router.beforeEach()

``` flow
st=>start: 开始
hasToken=>condition: 是否有token?
toPathLogin=>condition: 目标url是否为/Login?
redirectToRoot=>operation: 重定向到 /
hasRoles=>condition: 本地是否存有角色信息?
next=>operation: next
getUserInfo=>operation: 更新vuex用户信息_获取用户角色
generateRoutes=>operation: 根据角色获取动态路由
addRoutes=>operation: 添加动态路由
nextTo=>operation: nextTo
nextToLogin=>operation: nextTo(login)
removeTokenAndReLogin=>operation: 移除token并定向到登录页重新登录
whiteList=>condition: 是否在白名单?

st(right)->hasToken
hasToken(yes)->toPathLogin
hasToken(no)->whiteList
toPathLogin(yes)->redirectToRoot
toPathLogin(no)->hasRoles
hasRoles(yes)->next
hasRoles(no)->getUserInfo->generateRoutes->addRoutes->nextTo
whiteList(yes)->next
whiteList(no)->nextToLogin
```

- getUserInfo得到的获取用户信息的数据格式

``` javascript
{
  'admin-token': {
    roles: ['admin'],
    introduction: 'I am a super administrator',
    avatar: 'https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif',
    name: 'Super Admin'
}
```

#### src/utils/request.js
- axios interceptor拦截器处理token和错误码